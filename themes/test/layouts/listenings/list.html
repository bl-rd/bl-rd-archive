{{ define "main" }}

<div class="single list listenings">

  <header>
    <h1>{{ .Title }}</h1>
    <p>{{ .Description }}</p>
  </header>

  {{ .Content }}

  <ul>
  {{ range first 30 .Pages }}
    <li>
      <article>
        {{ $original := .Resources.GetMatch "*.jpg" }}
        {{ .Scratch.Set "image_large" ($original.Resize "250x")}}
        {{ .Scratch.Set "image_small" ($original.Resize "125x")}}
        {{ $image_large := .Scratch.Get "image_large" }}
        {{ $image_small := .Scratch.Get "image_small" }}
        {{ $alt := print "Album art for " .Title }}
        <picture>
          <source srcset="{{ $image_small.RelPermalink }}" media="(max-width: 66rem)">
          <img src="{{ $image_large.RelPermalink }}" alt="{{ $alt }}"/>
        </picture>
        <div>
          <h2><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
          <small>
            <time timestamp="{{ .PublishDate.Format "2006-01-02T15:04:05Z" }}">{{ .PublishDate.Format "2 January 2006" }}</time>
          </small>
          <div>
            {{ .Content | markdownify }}
            <ul>
              {{ with .Params.artist }}
              <li class="flex-basis:100">Artist: <b>{{ . }}</b></li>
              {{ end}}
              {{ with .Params.bandcampUrl }}
              <li><a rel="noopener nofollow" href="{{.}}">BandCamp</a></li>
              {{ end }}
              {{ with .Params.spotifyUrl }}
              <li><a rel="noopener nofollow" href="{{.}}">Spotify</a></li>
              {{ end }}
            </ul>
          </div>
        </div>
      </article>
    </li>
  {{ end }}
  </ul>
</div>
{{ end }}